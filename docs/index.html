<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
"http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-us">
  <head>
    <title>GnuPGInterface Python module</title>
    <link rev="Made" href="mailto:ftobin@uiuc.edu" />
    <link rel="StyleSheet"           title="Default"  href="style/main.css" type="text/css" />
    <link rel="Alternate StyleSheet" title="Midnight" href="style/midnight.css" type="text/css" />
  </head>
  <body>
    
    <h1>GnuPGInterface Python module</h1>
    
    <p>
      GnuPGInterface is a Python module to interface with <a href="http://www.gnupg.org/">GnuPG</a>.
      It concentrates on interacting with GnuPG via filehandles, providing access
      to control GnuPG via versatile and extensible means.
    </p>
    
    <p>
      This module is based on
      <a href="http://gnupg-interface.sourceforge.net/">GnuPG::Interface</a>, a Perl module
      by the same author.
    </p>
    
    <h2>Example</h2>
    
<pre>
import os
import GnuPGInterface

# in this example, we'll be signing /etc/motd,
# and then print it out to stdout,
# with each line prefixed with "signed: "
# (of course, this would destroy the signature)
# but this is for illustrative purposes

motd = open( '/etc/motd' )
gnupg = GnuPGInterface.GnuPGInterface()
gnupg.passphrase = 'three little pigs'
gnupg.options.armor = 1
gnupg.options.meta_interactive = 0

# we want the stdout directly to us,
# but have GnuPG read in the motd directly from the file
process = gnupg.run( [ '--decrypt' ], stdin = motd, stdout = 1 )

g_stdout = process.handles['stdout']

line = g_stdout.readline()
while line != '':
    print "signed:", line
    line = g_stdout.readline()

os.waitpid( process.pid, 0 )

</pre>
    
    <h2>Classes</h2>
    
    <h3>GnuPGInterface</h3>
    
<pre>
gnupg = GnuPGInterface.GnuPGInterface()
</pre>

    <p>This object is used to make calls to GnuPG.</p>
    
    <h4>Attributes</h4>
    
    <dl>
      <dt>call</dt>
      <dd>String representing call made to run GnuPG.  Defaults to 'gpg'.</dd>
      
      <dt>passphrase</dt>
      <dd>Convenient way to send passphrase to GnuPG.
	See <a href="#using_passphrase">Using the passphrase attribute</a>.</dd>
      
      <dt>options</dt>
      <dd>
	<a href="#Options">GnuPGInterface.Options</a> object, used to determine which options
	to pass to GnuPG.
      </dd>
      
    </dl>
      
    <h4>Methods</h4>
    
    <dl>
      <dt>constructor</dt>
      <dd>The constructor takes no arguments, and simply does some attribute initializations.</dd>
      
      <dt id="run">run(<var>gnupg_commands</var> [, <var>fh_request</var>, ... ])</dt>
      <dd>
	<p>
	  Calls GnuPG with the <strong>list</strong>
	  of string commands <var>gnupg_commands</var>,
	  complete with prefixing dashes.
	  For example, <var>gnupg_commands</var> could be
	  <code>[ '--sign', '--encrypt' ]</code>.
	  Returns a <a href="#Process">GnuPGInterface.Process</a> object.
	</p>
	
	<p>
	  <var>fh_request</var>s are named parameters corresponding to filehandle
	  names to be connected with the GnuPG process.  Valid names are:
	</p>
	
	<ul>
	  <li>stdin</li>
	  <li>stdout</li>
	  <li>stderr</li>
	  <li>passphrase</li>
	  <li>command</li>
	  <li>logger</li>
	  <li>status</li>
	</ul>
	
	<p>The purpose of each filehandle is described in the GnuPG documentation.</p>
	
	<p>
	  Valid values for each filehandle name are either non-FileObject booleans,
	  or FileObjects.  If not set, <var>fh_request</var>s which
	  are a std* are defaulted to the running process' version of handle.
	  Otherwise, that type of handle is simply not used when calling GnuPG>
	  For example, if you do not care about getting data from GnuPG's
	  status filehandle, simply do not specify it.
	</p>
	
	<p>
	  If a filehandle name has a non-FileObject value which is true,
	  after run() returns, the returned
	  <a href="#Process">GnuPGInterface.Process</a> object will have an attribute
	  of <span class="key">handles</span>,
	  which is a mapping from the handle name (such as stdin or command)
	  to the respective FileObject  connected to the GnuPGInterface object.
	  For instance, if the call was
	  <code>process = gnupg.run( [ '--decrypt' ], stdin = 1 )</code>,
	  after run returns
	  <code>process.handles['stdin']</code>
	  is a file object connected to GnuPG's standard input, and can be written to.
	</p>
	
	<p>
	  If a non-FileObject boolean is sent in and is false, it is simply
	  as if it was never specified in the call.
	</p>
	
	<p>
	  If a FileObject is given, then the GnuPG process will read/write
	  directly to/from that object.  This is useful if you want
	  GnuPG to read/write to/from an existing file.
	  For instance:
	</p>
	
<pre>
f = open( 'encrypted.gpg' )
gnupg.run( [ '--decrypt' ], stdin = f )
</pre>
      </dd>
    </dl>
    
    <h4 id="using_passphrase">Using the passphrase attribute</h4>
    
    <p>
      Since it is a common operation to pass in a passphrase to GnuPG,
      and working with the passphrase filehandle mechanism directly
      can be mundane, if set, the passphrase attribute
      works in a special manner.
      If the passphrase attribute is set, and no passphrase file object is sent in to run(),
      then GnuPGInterface will take care of sending the passphrase to GnuPG,
      instead of having the user sent it in manually.
    </p>
    
    <h3 id="Process">GnuPGInterface.Process</h3>

<pre>
# gnupg is a GnuPGInterface.GnuPGInterface object
process = gnupg.run( [ '--decrypt' ], stdout = 1 )
g_stdout = process.handles['stdout']
...
os.waitpid( process.pid, 0 )
</pre>
    
    <p>
      Objects of this class encompass properties of a GnuPG
      process spawned by GnuPGInterface's <a href="#run">run()</a>
    </p>
    
    <h4>Attributes</h4>
    
    <dl>
      <dt>handles</dt>
      <dd>
	This is a map of filehandle-names to the file handles, if any, that were
	requested via <a href="#run">run()</a> and hence
	are connected to the running GnuPG process.  Valid names
	of this map are only those handles that were requested.
      </dd>
      
      <dt>pid</dt>
      <dd>
	The <abbr title="Process Identifier">PID</abbr> of the spawned
	GnuPG process.  Useful to know, since once should call
	<code>os.waitpid()</code> to clean up the process, especially
	if multiple calls are made to <a href="#run">run()</a>.
      </dd>
    </dl>
    
    
    <h4>Methods</h4>
    
    <p>
      None
    </p>
    
    <h3 id="Options">GnuPGInterface.Options</h3>

<pre>
# gnupg is a GnuPGInterface.GnuPGInterface object
gnupg.options.armor = 1
</pre>
    
    <p>
      Objects of this class encompass options passed to GnuPG.
      Responsible for determining command-line arguments which
      are based on options.  It can be said that a GnuPGInterface
      object <em>has-a</em> GnuPGInterface.Options object in its options attribute.
    </p>
    
    <h4>Attributes</h4>
    
    <h5>Attributes which correlate directly to GnuPG options</h5>
    
    <p>
      Each option here defaults to false or None, and is described in
      GnuPG documentation.
    </p>
    
    <h6>Booleans</h6>
    
    <ul>
      <li>armor</li>
      <li>no_greeting</li>
      <li>no_verbose</li>
      <li>quiet</li>
      <li>batch</li>
      <li>always_trust</li>
      <li>rfc1991</li>
      <li>openpgp</li>
      <li>force_v3_sigs</li>
      <li>no_options</li>
      <li>textmode</li>
    </ul>
    
    <h6>Strings</h6>
      
    <ul>
      <li>homedir</li>
      <li>default_key</li>
      <li>comment</li>
      <li>compress_algo</li>
      <li>options</li>
    </ul>
    
    <h6>Lists</h6>
    
    <ul>
      <li>recipients</li>
      <li>encrypt_to</li>
    </ul>
    
    <h5>Meta options</h5>
    
    <p>
      Meta options are options provided by this module that do not correlate directly
      to any GnuPG option by name, but are rather bundle of options used to accomplish
      a specific goal, such as obtaining compatibility with PGP 5.
      The actual arguments each of these reflects may change with time.  Each
      defaults to false unless otherwise specified.
    </p>
    
    <dl>
      <dt>meta_pgp_5_compatible</dt>
      <dd>If true, arguments are generated to try to be compatible with PGP 5.x.</dd>
      
      <dt>meta_pgp_2_compatible</dt>
      <dd>If true, arguments are generated to try to be compatible with PGP 2.x.</dd>
      
      <dt>meta_interactive</dt>
      <dd>
	If false, arguments are generated to try to help the
	using program use GnuPG in a non-interactive
	environment, such as CGI scripts.  Default is true.
      </dd>
      
    </dl>
    
    <h5>extra_args</h5>
    
    <p>
      Extra option arguments may be passed in via the attribute extra_args, a list.
    </p>
    
    <h4>Methods</h4>
    
    <p>None</p>
    
    <h2>Copyright</h2>
    
    <p>
      GnuPGInterface, a Python GnuPG interface,
      Copyright &copy; 2001 <a href="mailto:ftobin@uiuc.edu">Frank J. Tobin</a>
    </p>
    
    <p>
      This program is
      <a href="http://www.fsf.org/philosophy/free-sw.html">free software</a>;
      you can redistribute it and/or modify it under the terms of the
      <a href="http://www.gnu.org/copyleft/gpl.html">GNU General Public License</a>
      as published by the <a href="http://www.fsf.org/">Free Software Foundation</a>;
      either version 2 of the License, or (at your option) any later version.
    </p>
    
    <p>
      This program is distributed in the hope that it will be useful,
      but <strong>without any warranty</strong>; without even the implied warranty of
      <em>merchantability</em> or <em>fitness for a particular purpose</em>.  See the
      GNU General Public License for more details.
    </p>

  </body>
</html>

